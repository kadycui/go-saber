# 包管理

## 1-工作区
```shell
GO工作区:
 ├─bin
 │ ...
 ├─pkg
 │ └─windows_amd64
 │ ├─github.com
 │ ...
 └─src
 ├─github.com
 ...
```
### 1.1-各目录的作用

- src目录：用于以代码包的形式组织并保存Go源码文件（如.go、.c、.h、.s等），同时也是Go编译时查找代码的地方。
- pkg目录：用于存放经由go get/install命令构建安装后的代码包的“.a”归档文件，也是编译
  生成的lib文件存储的地方。
- bin目录：与pkg目录类似，在通过go get/install命令完成安装后，保存由Go命令源码文件生
  成的可执行文件。

目录src用于包含所有的源代码，是Go命令行工具一个强制的规则，而pkg和bin则无须手动创
  建，必要时Go命令行工具在构建过程中会自动创建这些目录。

### 1.2 GOPATH
GOPATH可以理解为工作目录或工作区，也是平时接触最多的一个环境变量。它可以是一个目
录，也可以是多个目录路径，每个目录代表一个工作区。

Go的所有操作（编码、依赖管理、构建、测试、安装等）基本上都是围绕GOPATH来进行
的。GOPATH必须要设置，但并不是固定不变的，GOPATH的目的是为了告知Go需要代码的时候去
哪里查找。需要注意的是，这里的代码包括本项目和引用外部项目的代码。GOPATH可以随着项目
的不同而重新设置。

在实际开发环境中，工作目录往往有多个。这些工作目录的目录路径都需要添加至GOPATH。
为了能够构建这个工程，需要先把所需工程的根目录加入到环境变量GOPATH中。否则，即使处于
同一工作目录（工作区），代码之间也无法通过绝对代码包路径完成调用

**如果GOPATH设置了多个工作区，那么查找依赖包时是以怎样的顺序进行呢？例如包a依赖包
b，包b依赖包c，那么会先查找c包。那在工作区是如何查找这个依赖包c的呢？**
> 首先，在查找依赖包的时候，总是会先查找GOROOT目录，也就是Go语言的安装目录，如果
没有找到依赖的包，才到工作区去找相应的包。在工作区中是按照设置的先后顺序来查找的，也
就是会从第一个开始依次查找，如果找到就不再继续，如果没有找到就报错。
如果多个工作区中存在导入路径相同的代码包会产生冲突吗？不冲突，因为按顺序找到所需
要的包就不往后继续找了

### 1.3 GOROOT
GOROOT是Go语言的程序安装目录，并非必须要设置的。Linux默认Go会安装在/usr/local/go下，
但也允许自定义安装位置。GOROOT的目的就是告知Go当前的安装位置，编译的时候从GOROOT去
找SDK的system library。
### 1.4 GOBIN
GOBIN目录一般为GOPATH的可执行文件放置目录，一般指bin。默认安装的Go语言是没有设
置GOBIN目录的。
需要注意的是，只有当环境变量GOPATH中只包含一个工作区的目录路径时，go install命令
才会把命令源码安装到当前工作区的bin目录下。若环境变量GOPATH中包含多个工作区的目录路
径，像这样执行go install命令就会失效，此时必须设置环境变量GOBIN。

## 2-包的声明
包是结构化代码的一种方式：每个程序都由包（通常简称为pkg）的概念组成，可以使用自身
的包或者从其他包中导入内容。我们先来了解一下Go语言源码的组织方式：

◇ Go语言的源代码以代码包为基本的组织单位。

◇ 在文件系统中，代码包是与文件目录一一对应的，文件目录的子目录也就是代码包的
子包。

◇ 在工作区中，一个代码包的导入路径实际上就是从src子目录到该包的实际存储位置的相对
路径。

每一个Go源文件的第一行都需要声明包的名称，声明一个包使用关键字package。如声明一个
main包：
> package main

如同其他一些编程语言中的类库或命名空间的概念，每个Go文件都属于且仅属于一个包。一
个包可以由许多以“.go”为扩展名的源文件组成，因此文件名和包名一般来说都是不相同的。
代码包的名称一般会与源码文件所在的目录同名，如果不同名，在构建和安装的过程中会以
代码包的名称为准。

在Go语言中，代码包中的源码文件名可以是任意的。但是，这些任意名称的源码文件都必须
以包声明语句作为文件中的第一行，每个包都对应一个独立的名字空间。

包中成员以名称首字母大小写决定访问权限：

◇ public：首字母大写，可被包外访问。

◇ private：首字母小写，仅包内成员可以访问。

注意：同一个目录下不能定义不同的package。

## 3-main包
在Go语言中，命名为main的包具有特殊的含义。Go语言的编译程序会试图把这种名字的包编
译为二进制可执行文件。所有用Go语言编译的可执行程序都必须有一个名叫main的包，main包有
且仅有一个。

当编译器发现某个包的名字为main时，它一定也会发现名为main()的函数，否则不会创建可执
行文件。main()函数是程序的入口，所以，如果没有这个函数，程序就没有办法开始执行。程序编
译时，会使用声明main包的代码所在的目录名称作为可执行文件的文件名。

一个应用程序可以包含不同的包，而且即使你只使用main包也不必把所有的代码都写在一个
巨大的文件里，你可以用一些较小的文件，并且在每个文件非注释的第一行都使用package main来
指明这些文件都属于main包。如果你打算编译包名不为main的源文件，如mypack，编译后产生的对
象文件将会是mypack.a而不是可执行程序。

**另外要注意的是，所有的包名都应该使用小写字母**


## 4-包的初始化
在Go语言里面有两个保留的函数：init函数（能够应用于所有的package）和main函数（只能应
用于package main）。这两个函数在定义时不能有任何的参数和返回值。虽然一个package里面可以
写任意多个init函数，但无论是对于可读性还是以后的可维护性来说，我们都强烈建议用户在一个
package中，每个文件只写一个init函数。
我们导入了一个包就可以使用该包中的常量和变量，当然这些常量和变量必须是可导出的